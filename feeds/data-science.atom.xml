<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Cody Hatch - Data Science</title><link href="https://codyhatch.com/" rel="alternate"></link><link href="https://codyhatch.com/feeds/data-science.atom.xml" rel="self"></link><id>https://codyhatch.com/</id><updated>2021-09-06T05:35:00-06:00</updated><subtitle></subtitle><entry><title>US Federal Income and Spending</title><link href="https://codyhatch.com/data-science/us-federal-income-spending.html" rel="alternate"></link><published>2021-09-06T05:35:00-06:00</published><updated>2021-09-06T05:35:00-06:00</updated><author><name>Cody Hatch</name></author><id>tag:codyhatch.com,2021-09-06:/data-science/us-federal-income-spending.html</id><summary type="html">&lt;p&gt;Charts showing United States federal government income and spending by category.&lt;/p&gt;</summary><content type="html">&lt;p&gt;Part of being an informed citizen of the United States is to understand in what ways the federal government spends the money it collects, as well as the sources of government revenue. To aid in that understanding, I have provided two basic charts covering receipts and expenses for the US federal government. All amounts have been adjusted to 1995 dollars using CPI-U from the US Bureau of Labor Statistics.&lt;/p&gt;
&lt;div class="flourish-embed flourish-chart" data-src="visualisation/3958773" data-url="https://flo.uri.sh/visualisation/3958773/embed" aria-label=""&gt;&lt;script src="https://public.flourish.studio/resources/embed.js"&gt;&lt;/script&gt;&lt;/div&gt;

&lt;div class="flourish-embed flourish-chart" data-src="visualisation/3958865" data-url="https://flo.uri.sh/visualisation/3958865/embed" aria-label=""&gt;&lt;script src="https://public.flourish.studio/resources/embed.js"&gt;&lt;/script&gt;&lt;/div&gt;</content><category term="Data Science"></category><category term="US"></category><category term="politics"></category><category term="budgets"></category><category term="statistics"></category></entry><entry><title>Utah COVID-19 Statistics</title><link href="https://codyhatch.com/data-science/utah-covid19-stats.html" rel="alternate"></link><published>2021-01-10T22:00:00-07:00</published><updated>2021-01-10T22:00:00-07:00</updated><author><name>Cody Hatch</name></author><id>tag:codyhatch.com,2021-01-10:/data-science/utah-covid19-stats.html</id><summary type="html">&lt;p&gt;Reviewing COVID-19 statistics for Utah.&lt;/p&gt;</summary><content type="html">&lt;p&gt;COVID-19 in Utah, like everywhere else, has been a story of tragedy and heroism (especially the healthcare workers, people staffing food banks, and other essential workers). I am interested in some basic statistics regarding the virus in Utah, which I have placed here along with some commentary; however, it is imperative to remember that every death and painful recovery creates a web of grief. These numbers represent human tragedy, so take a moment to reach out to a loved one you know has been affected, and remind them of your love for them.&lt;/p&gt;
&lt;div class="flourish-embed flourish-chart" data-src="visualisation/3957738" data-url="https://flo.uri.sh/visualisation/3957738/embed" aria-label=""&gt;&lt;script src="https://public.flourish.studio/resources/embed.js"&gt;&lt;/script&gt;&lt;/div&gt;

&lt;p&gt;I have heard many acquaintances advocate letting things play out to achieve herd immunity. While the numbers needing to be infected in order to achieve herd immunity vary with each virus, studies have predicted that COVID-19 would require approximately a 70% infection rate in order for a community to reach herd immunity. Currently in Utah there have been about 306,000 people infected and 1,393 fatalities, for a mortality rate of 0.46%. Utah has a population of 3,200,000 and 70% of that population would be 2,240,000. If 0.46% of that population were to die from the disease, it would represent 10,197 deaths - almost more than all other causes combined.&lt;/p&gt;
&lt;div class="flourish-embed flourish-chart" data-src="visualisation/3958146" data-url="https://flo.uri.sh/visualisation/3958146/embed" aria-label=""&gt;&lt;script src="https://public.flourish.studio/resources/embed.js"&gt;&lt;/script&gt;&lt;/div&gt;

&lt;p&gt;I also was curious how Utah's mortality rate stacks up against several other western states. Interestingly, Utah compares very favorably, especially considering the large population in metropolitan centers. I'm not sure why this is so, but it is interesting nonetheless.&lt;/p&gt;
&lt;div class="flourish-embed flourish-chart" data-src="visualisation/3958406" data-url="https://flo.uri.sh/visualisation/3958406/embed" aria-label=""&gt;&lt;script src="https://public.flourish.studio/resources/embed.js"&gt;&lt;/script&gt;&lt;/div&gt;</content><category term="Data Science"></category><category term="Utah"></category><category term="statistics"></category><category term="health"></category><category term="COVID"></category><category term="coronavirus"></category></entry><entry><title>US Mean Income</title><link href="https://codyhatch.com/data-science/us-mean-income.html" rel="alternate"></link><published>2018-09-24T04:00:00-06:00</published><updated>2018-09-24T04:00:00-06:00</updated><author><name>Cody Hatch</name></author><id>tag:codyhatch.com,2018-09-24:/data-science/us-mean-income.html</id><summary type="html">&lt;p&gt;Graphing the growing income disparity between 1967 and 2017.&lt;/p&gt;</summary><content type="html">&lt;p&gt;There is a growing income disparity in the United States, which I find very worrisome. It doesn't seem sustainable and creates a nation of haves and have-nots.&lt;/p&gt;
&lt;p&gt;The graph below shows US mean household income, in 2017 CPI adjusted dollars, from 1967 to 2017. It is broken into quintiles and includes the top five percent of earners for comparison. I’ve also added the percentage growth for each line during the 50-year timespan.&lt;/p&gt;
&lt;p&gt;I also calculated the ratio of “top five percent”-to-“lowest quintile” for 1967 and 2017.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;1967:&lt;/strong&gt; 17.5/1&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;2017:&lt;/strong&gt; 29.0/1&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="svg" src="https://codyhatch.com/images/us-mean-income.svg"&gt;&lt;/p&gt;</content><category term="Data Science"></category><category term="US"></category><category term="economy"></category><category term="income"></category></entry><entry><title>Analyzing LDS President Russell Nelson Talks About Family</title><link href="https://codyhatch.com/data-science/analyzing-lds-president-russell-nelson-talks-family.html" rel="alternate"></link><published>2018-02-20T23:00:00-07:00</published><updated>2018-02-20T23:00:00-07:00</updated><author><name>Cody Hatch</name></author><id>tag:codyhatch.com,2018-02-20:/data-science/analyzing-lds-president-russell-nelson-talks-family.html</id><summary type="html">&lt;p&gt;Analyzing the frequency family-oriented topics are discussed by LDS President Russell Nelson&lt;/p&gt;</summary><content type="html">&lt;p&gt;Several friends and I were recently discussing whether Wendy Watson Nelson has affected the topics about which LDS President Russell Nelson has chosen to speak, so I decided to perform a quick analysis of his General Conference talks going back to 1995.&lt;/p&gt;
&lt;p&gt;First, though, for those unfamiliar with why we would be interested in this question, I’ll give a bit of background. According to &lt;a href="https://www.mormonnewsroom.org/article/elder-russell-m.-nelson-marries-wendy-l.-watson"&gt;LDS Newsroom&lt;/a&gt;, President Russell Nelson and Wendy Watson Nelson were married April 6, 2006. Wendy Watson was President Nelson’s second wife. His first wife was Dantzel White Nelson, who died February 12, 2005.&lt;/p&gt;
&lt;p&gt;Sister Wendy Watson Nelson was a professor of marriage and family therapy at BYU prior to her marriage to President Nelson, and had written several books about relationships, marriage, and family. Since they have been married, she, along with President Nelson, has spoken at several firesides and face-to-face events, most recently in Las Vegas, Nevada. She frequently provides marriage and relationship advice at these events. She is highly educated, has teaching experience in these topics, is willing to speak frequently on these topics, and is much younger than President Nelson. Naturally, we were curious as to what type of influence, if any, she might have on President Nelson’s talks.&lt;/p&gt;
&lt;p&gt;Since President and Sister Nelson were married in April 2006, in performing my analysis I had initially thought I’d grab all of President Nelson’s talks going back to 1995 so as to get a similar number of years pre-marriage as there are available post-marriage; however, I was unable to find any way on lds.org to sort President Nelson’s talks chronologically. I had considered sucking down all of his talks from the site and sorting them myself, but was reluctant to do so due to potential loads that might place on the Church’s web servers (there are a lot of talks). It just seemed like I’d be crossing some line, so I settled on General Conference talks. I downloaded all of President Nelson’s General Conference talks going back to April 1995 and ran them through a tool that performs a word count on the text. I kept the top ten words used in each talk and added them to a data frame within a Python program. Finally, I filtered the talks for words associated with marriage and family (the areas of Sister Nelson’s expertise), and then graphed them on a time series chart along with a reference line for the Nelson’s marriage.&lt;/p&gt;
&lt;p&gt;&lt;img alt="svg" src="https://codyhatch.com/images/pres-nelson-family.svg"&gt;&lt;/p&gt;</content><category term="Data Science"></category><category term="Religion"></category><category term="data science"></category></entry><entry><title>Analyzing Questions for Oaks and Ballard Face-to-Face</title><link href="https://codyhatch.com/data-science/analyzing-oaks-ballard-face-to-face-questions.html" rel="alternate"></link><published>2017-11-16T19:00:00-07:00</published><updated>2017-11-16T19:00:00-07:00</updated><author><name>Cody Hatch</name></author><id>tag:codyhatch.com,2017-11-16:/data-science/analyzing-oaks-ballard-face-to-face-questions.html</id><summary type="html">&lt;p&gt;Analyzing the questions submitted for the Oaks and Ballard LDS Face-to-Face event&lt;/p&gt;</summary><content type="html">&lt;p&gt;There is an upcoming event in the LDS Church (Mormon Church) where two leaders from the Church's hierarchy will answer questions submitted by some of the young single adults in the Church. There are about 2,600 questions submitted thus far and they are posted to a website. I wrote a Python script to scrape the questions and do text analysis on their content.&lt;/p&gt;
&lt;p&gt;I stemmed and tokenized the words, ran them through a count vectorizer to get term counts, and then performed &lt;a href="http://scikit-learn.org/stable/modules/decomposition.html#nmf"&gt;non-negative matrix factorization&lt;/a&gt; to group the texts into topics. I then performed NMF on subsets of the questions which had been filtered according to various topics or keywords.&lt;/p&gt;
&lt;p&gt;I posted my analysis at Wheat &amp;amp; Tares:&lt;/p&gt;
&lt;p&gt;&lt;a href="https://wheatandtares.org/2017/11/15/analyzing-ballard-and-oaks-face-to-face-questions/"&gt;Analyzing Ballard and Oaks Face-to-Face Questions&lt;/a&gt;&lt;/p&gt;</content><category term="Data Science"></category><category term="Religion"></category><category term="data science"></category></entry><entry><title>Lending Club Machine Learning Model and API</title><link href="https://codyhatch.com/data-science/lending-club-default-predictor.html" rel="alternate"></link><published>2017-08-23T17:35:00-06:00</published><updated>2017-08-23T17:35:00-06:00</updated><author><name>Cody Hatch</name></author><id>tag:codyhatch.com,2017-08-23:/data-science/lending-club-default-predictor.html</id><summary type="html">&lt;p&gt;Lending Club machine learning model and API for predicting loan defaults&lt;/p&gt;</summary><content type="html">&lt;p&gt;This is an API that provides a probability of default when presented a loan from Lending Club. The API is written in Flask and it utilizes a scikit-learn machine learning model.&lt;/p&gt;
&lt;p&gt;You can get the code for this at the &lt;a href="https://github.com/orangganjil/lendingclub-default-predictor"&gt;GitHub repo&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;Prerequisites&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Python 3&lt;/li&gt;
&lt;li&gt;Flask&lt;/li&gt;
&lt;li&gt;Flask-RESTful&lt;/li&gt;
&lt;li&gt;numpy&lt;/li&gt;
&lt;li&gt;scipy&lt;/li&gt;
&lt;li&gt;pandas&lt;/li&gt;
&lt;li&gt;scikit-learn (0.19.0) - pickled model may be version dependent&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Installation&lt;/h2&gt;
&lt;p&gt;Installation is completely up to you but it expects the typical Flask environment with the two pickled scikit-learn models in the same directory as the Flask app (this can be changed by modifying the joblib path within the app).&lt;/p&gt;
&lt;h2&gt;Usage&lt;/h2&gt;
&lt;p&gt;The API expects a JSON file conforming to the current format from Lending Club. There is an example JSON file called &lt;code&gt;loanlist-example.json&lt;/code&gt; showing the format the model expects.&lt;/p&gt;
&lt;p&gt;There are three endpoints to the API:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;/ (provides a readme/description)&lt;/li&gt;
&lt;li&gt;/version (provides a JSON output of the API version)&lt;/li&gt;
&lt;li&gt;/predict (this is the predictor)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To use the API, POST a JSON file matching the format of the example file provided. Be sure to set your Content-Type to &lt;code&gt;application\json&lt;/code&gt; for the POST.&lt;/p&gt;
&lt;p&gt;The API will then load the loans into a Pandas DataFrame, make some modifications, and then run them through the Random Forest Classifier model. It then will add another column to the DataFrame for the predicted probability of default/charge-off. Finally, the API will then return JSON output of the memberId and probability of default for each loan that was input.&lt;/p&gt;
&lt;h2&gt;Machine Learning Model&lt;/h2&gt;
&lt;p&gt;The machine learning model is a Random Forest Classifier trained on all Lending Club loans from 2007 through the first half of 2017. It has the following parameters:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;RandomForestClassifier(bootstrap=True, class_weight=&amp;#39;balanced&amp;#39;,&lt;/span&gt;
&lt;span class="err"&gt;            criterion=&amp;#39;gini&amp;#39;, max_depth=None, max_features=&amp;#39;auto&amp;#39;,&lt;/span&gt;
&lt;span class="err"&gt;            max_leaf_nodes=None, min_impurity_split=1e-07,&lt;/span&gt;
&lt;span class="err"&gt;            min_samples_leaf=5, min_samples_split=2,&lt;/span&gt;
&lt;span class="err"&gt;            min_weight_fraction_leaf=0.0, n_estimators=100, n_jobs=3,&lt;/span&gt;
&lt;span class="err"&gt;            oob_score=False, random_state=None, verbose=0,&lt;/span&gt;
&lt;span class="err"&gt;            warm_start=False)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Below is the confusion matrix followed by the accuracy, AUC, precision, and recall scores for the model:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align="center"&gt;True Positive &lt;br&gt;False Positive&lt;/th&gt;
&lt;th align="left"&gt;False Negative &lt;br&gt;True Negative&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align="center"&gt;74,319&lt;/td&gt;
&lt;td align="left"&gt;4,546&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;1,870&lt;/td&gt;
&lt;td align="left"&gt;16,393&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;Accuracy&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.933942838316&lt;/span&gt;
&lt;span class="n"&gt;Error&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.0660571616836&lt;/span&gt;
&lt;span class="n"&gt;AUC&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.919982188297&lt;/span&gt;
&lt;span class="n"&gt;Precision&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.782893165863&lt;/span&gt;
&lt;span class="n"&gt;Recall&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.897607183924&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;If you are unfamiliar with a confusion matrix, in a binary decision such as whether an account is likely to default, the matrix lists in the first column the number of true positives over false positives. The second column lists the number of false negatives over true negatives. Ideally, one would like the numbers to be greatest going diagonally from top-left to bottom-right, with zeros in the other two cells.&lt;/p&gt;
&lt;p&gt;You can read more about a confusion matrix on &lt;a href="https://en.wikipedia.org/wiki/Confusion_matrix"&gt;Wikipedia&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The two models used in the API are the following:&lt;/p&gt;
&lt;h4&gt;Label Encoder&lt;/h4&gt;
&lt;p&gt;Used for both the "term" and "grade" columns/features to encode them into labels. This, rather than one-hot encoding, was used due to the simplicity of the features and in an attempt to keep the feature size to a minimum (one of my goals was to enable this to run on a Raspberry Pi). It is important that this label encoder be loaded so that labels for new loans are consistent with those of the training set.&lt;/p&gt;
&lt;h4&gt;Random Forest Classifier&lt;/h4&gt;
&lt;p&gt;This model is a random forest classifier with 100 trees. It does the predicting, returning an array consisting of the probability a loan will not default along with the probability it will. The API is only returning the probability of default - the second field returned by the model.&lt;/p&gt;
&lt;h3&gt;Performance&lt;/h3&gt;
&lt;p&gt;The classifier is pretty quick and should work just fine on even a Raspberry Pi.&lt;/p&gt;</content><category term="Data Science"></category><category term="Machine Learning"></category><category term="lending club"></category><category term="defaults"></category></entry><entry><title>Utah Energy Production</title><link href="https://codyhatch.com/data-science/utah-energy-production.html" rel="alternate"></link><published>2016-09-14T19:35:00-06:00</published><updated>2016-09-14T19:35:00-06:00</updated><author><name>Cody Hatch</name></author><id>tag:codyhatch.com,2016-09-14:/data-science/utah-energy-production.html</id><summary type="html">&lt;p&gt;Discussing the sources of Utah's energy production between 1990 and 2013.&lt;/p&gt;</summary><content type="html">&lt;p&gt;When I read &lt;a href="http://www.sltrib.com/home/3641085-155/utah-legislature-oks-53-million-cash"&gt;so&lt;/a&gt; &lt;a href="http://www.sltrib.com/home/3699366-155/proponents-buried-coals-role-in-oakland"&gt;many&lt;/a&gt; &lt;a href="http://www.sltrib.com/home/3911450-155/miners-fear-federal-coal-reforms-jeopardize"&gt;articles&lt;/a&gt; &lt;a href="http://www.sltrib.com/home/3423489-155/obama-administration-halts-new-coal-leases"&gt;about&lt;/a&gt; &lt;a href="http://www.sltrib.com/opinion/3362446-155/op-ed-coal-to-liquid-project-shows-utah-still"&gt;Utah's&lt;/a&gt; &lt;a href="http://www.sltrib.com/home/2953530-155/environmentalists-sue-to-halt-sanpete-county"&gt;coal industry&lt;/a&gt; and the lack of real concern about &lt;a href="http://www.sltrib.com/home/3464221-155/crowd-of-deeply-divided-utahns-pack"&gt;coal-plant pollution&lt;/a&gt; in Utah, I reflect on this little chart I've had sitting around for some time now.&lt;/p&gt;
&lt;p&gt;I grabbed the data from &lt;a href="https://opendata.utah.gov/"&gt;Utah's Open Data Portal&lt;/a&gt; which, unfortunately, only has data up through 2013.&lt;/p&gt;
&lt;p&gt;&lt;img alt="svg" src="https://codyhatch.com/images/utah-energy-production/utah-energy-sources.svg"&gt;&lt;/p&gt;</content><category term="Data Science"></category><category term="Utah"></category><category term="economy"></category><category term="energy"></category><category term="politics"></category><category term="statistics"></category></entry></feed>